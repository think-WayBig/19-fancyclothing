/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
!function(e,t){if("function"==typeof define&&define.amd)define(["backbone","underscore"],(function(i,n){return e.Marionette=e.Mn=t(e,i,n)}));else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=t(e,i,n)}else e.Marionette=e.Mn=t(e,e.Backbone,e._)}(this,(function(e,t,i){"use strict";(function(e,t){var i=e.ChildViewContainer;e.ChildViewContainer=function(e,t){var i=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(i.prototype,{add:function(e,t){var i=e.cid;return this._views[i]=e,e.model&&(this._indexByModel[e.model.cid]=i),t&&(this._indexByCustom[t]=i),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var i=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,(function(e,t){return e===i?(delete this._indexByCustom[t],!0):void 0}),this),delete this._views[i],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,i){t.each(this._views,(function(n){t.isFunction(n[e])&&n[e].apply(n,i||[])}))},_updateLength:function(){this.length=t.size(this._views)}});return t.each(["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"],(function(e){i.prototype[e]=function(){var i=t.values(this._views),n=[i].concat(t.toArray(arguments));return t[e].apply(t,n)}})),i}(0,t),e.ChildViewContainer.VERSION="0.1.7",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=i,this},e.ChildViewContainer})(t,i),function(e,t){var i=e.Wreqr,n=e.Wreqr={};e.Wreqr.VERSION="1.3.3",e.Wreqr.noConflict=function(){return e.Wreqr=i,this},n.Handlers=function(e,t){var i=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events,{setHandlers:function(e){t.each(e,(function(e,i){var n=null;t.isObject(e)&&!t.isFunction(e)&&(n=e.context,e=e.callback),this.setHandler(i,e,n)}),this)},setHandler:function(e,t,i){var n={callback:t,context:i};this._wreqrHandlers[e]=n,this.trigger("handler:add",e,t,i)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(e,t),n.CommandStorage=function(){var i=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(i.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){this.getCommands(e).instances.push(t)},clearCommands:function(e){this.getCommands(e).instances=[]}}),i}(),n.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var i=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,i):this.storage.addCommand(e,i)},_executeCommands:function(e,i,n){var r=this.storage.getCommands(e);t.each(r.instances,(function(e){i.apply(n,e)})),this.storage.clearCommands(e)},_initializeStorage:function(e){var i,n=e.storageType||this.storageType;i=t.isFunction(n)?new n:n,this.storage=i}})}(n,t),n.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){return this.hasHandler(e)?this.getHandler(e).apply(this,t.rest(arguments)):void 0}})}(n,t),n.EventAggregator=function(e,t){var i=function(){};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events),i}(e,t),n.Channel=function(){var i=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,i,n){if(i){n=n||this;var r="vent"===e?"on":"setHandler";t.each(i,(function(i,s){this[e][r](s,t.bind(i,n))}),this)}}}),i}(),n.radio=function(e,t){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(i.prototype,{channel:function(e){if(!e)throw Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var i=this._channels[t];return i||(i=new e.Channel(t),this._channels[t]=i),i},_proxyMethods:function(){t.each(["vent","commands","reqres"],(function(e){t.each(n[e],(function(t){this[e][t]=r(this,e,t)}),this)}),this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,i,n){return function(r){var s=e._getChannel(r)[i];return s[n].apply(s,t.rest(arguments))}};return new i}(n,t),e.Wreqr}(t,i);var n=e.Marionette,r=e.Mn,s=t.Marionette={};s.VERSION="2.4.2",s.noConflict=function(){return e.Marionette=n,e.Mn=r,this},t.Marionette=s,s.Deferred=t.$.Deferred,s.extend=t.Model.extend,s.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},s.mergeOptions=function(e,t){e&&i.extend(this,i.pick(e,t))},s.getOption=function(e,t){return e&&t?e.options&&void 0!==e.options[t]?e.options[t]:e[t]:void 0},s.proxyGetOption=function(e){return s.getOption(this,e)},s._getValue=function(e,t,n){return i.isFunction(e)&&(e=n?e.apply(t,n):e.call(t)),e},s.normalizeMethods=function(e){return i.reduce(e,(function(e,t,n){return i.isFunction(t)||(t=this[t]),t&&(e[n]=t),e}),{},this)},s.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,(function(e){return t[e.slice(4)]}))},s.normalizeUIKeys=function(e,t){return i.reduce(e,(function(e,i,n){return e[s.normalizeUIString(n,t)]=i,e}),{})},s.normalizeUIValues=function(e,t,n){return i.each(e,(function(r,o){i.isString(r)?e[o]=s.normalizeUIString(r,t):i.isObject(r)&&i.isArray(n)&&(i.extend(r,s.normalizeUIValues(i.pick(r,n),t)),i.each(n,(function(e){var n=r[e];i.isString(n)&&(r[e]=s.normalizeUIString(n,t))})))})),e},s.actAsCollection=function(e,t){i.each(["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"],(function(n){e[n]=function(){var e=i.values(i.result(this,t)),r=[e].concat(i.toArray(arguments));return i[n].apply(i,r)}}))};var o=s.deprecate=function(e,t){i.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),void 0!==t&&t||o._cache[e]||(o._warn("Deprecation warning: "+e),o._cache[e]=!0)};o._warn="undefined"!=typeof console&&(console.warn||console.log)||function(){},o._cache={},s._triggerMethod=function(){function e(e,t,i){return i.toUpperCase()}var t=/(^|:)(\w)/gi;return function(n,r,s){var o=3>arguments.length;o&&(r=(s=r)[0]);var h,a="on"+r.replace(t,e),u=n[a];return i.isFunction(u)&&(h=u.apply(n,o?i.rest(s):s)),i.isFunction(n.trigger)&&(o+s.length>1?n.trigger.apply(n,o?s:[r].concat(i.drop(s,0))):n.trigger(r)),h}}(),s.triggerMethod=function(){return s._triggerMethod(this,arguments)},s.triggerMethodOn=function(e){var t=i.isFunction(e.triggerMethod)?e.triggerMethod:s.triggerMethod;return t.apply(e,i.rest(arguments))},s.MonitorDOMRefresh=function(e){function t(){e._isShown&&e._isRendered&&s.isNodeAttached(e.el)&&i.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}e.on({show:function(){e._isShown=!0,t()},render:function(){e._isRendered=!0,t()}})},function(e){function t(t,n,r,s){var o=s.split(/\s+/);i.each(o,(function(i){var s=t[i];if(!s)throw new e.Error('Method "'+i+'" was configured as an event handler, but does not exist.');t.listenTo(n,r,s)}))}function n(e,t,i,n){e.listenTo(t,i,n)}function r(e,t,n,r){var s=r.split(/\s+/);i.each(s,(function(i){var r=e[i];e.stopListening(t,n,r)}))}function s(e,t,i,n){e.stopListening(t,i,n)}function o(t,n,r,s,o){if(n&&r){if(!i.isObject(r))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=e._getValue(r,t),i.each(r,(function(e,r){i.isFunction(e)?s(t,n,r,e):o(t,n,r,e)}))}}e.bindEntityEvents=function(e,i,r){o(e,i,r,n,t)},e.unbindEntityEvents=function(e,t,i){o(e,t,i,s,r)},e.proxyBindEntityEvents=function(t,i){return e.bindEntityEvents(this,t,i)},e.proxyUnbindEntityEvents=function(t,i){return e.unbindEntityEvents(this,t,i)}}(s);var h=["description","fileName","lineNumber","name","message","number"];return s.Error=s.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+s.VERSION+"/",constructor:function(e,t){i.isObject(e)?e=(t=e).message:t||(t={});var n=Error.call(this,e);i.extend(this,i.pick(n,h),i.pick(t,h)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,s.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),s.Error.extend=s.extend,s.Callbacks=function(){this._deferred=s.Deferred(),this._callbacks=[]},i.extend(s.Callbacks.prototype,{add:function(e,t){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),n.then((function(i){t&&(i.context=t),e.call(i.context,i.options)}))},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=s.Deferred(),this._callbacks=[],i.each(e,(function(e){this.add(e.cb,e.ctx)}),this)}}),s.Controller=function(e){this.options=e||{},i.isFunction(this.initialize)&&this.initialize(this.options)},s.Controller.extend=s.extend,i.extend(s.Controller.prototype,t.Events,{destroy:function(){return s._triggerMethod(this,"before:destroy",arguments),s._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:s.triggerMethod,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption}),s.Object=function(e){this.options=i.extend({},i.result(this,"options"),e),this.initialize.apply(this,arguments)},s.Object.extend=s.extend,i.extend(s.Object.prototype,t.Events,{initialize:function(){},destroy:function(){return this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening(),this},triggerMethod:s.triggerMethod,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.Region=s.Object.extend({constructor:function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new s.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),s.Object.call(this,e)},show:function(e,t){if(this._ensureElement()){this._ensureViewIsIntact(e);var n=t||{},r=e!==this.currentView,o=!!n.preventDestroy,h=!!n.forceShow,a=!!this.currentView,u=r&&!o,c=r||h;if(a&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&delete this.currentView._parent,u?this.empty():a&&c&&this.currentView.off("destroy",this.empty,this),c){e.once("destroy",this.empty,this),e.render(),e._parent=this,a&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),s.triggerMethodOn(e,"before:show",e,this,t),a&&this.triggerMethod("swapOut",this.currentView,this,t);var l=s.isNodeAttached(this.el),d=[],f=i.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},n);return l&&f.triggerBeforeAttach&&(d=this._displayedViews(e),this._triggerAttach(d,"before:")),this.attachHtml(e),this.currentView=e,l&&f.triggerAttach&&(d=this._displayedViews(e),this._triggerAttach(d)),a&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),s.triggerMethodOn(e,"show",e,this,t),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var n=(t||"")+"attach";i.each(e,(function(e){s.triggerMethodOn(e,n,e,this)}),this)},_displayedViews:function(e){return i.union([e],i.result(e,"_getNestedViews")||[])},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new s.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new s.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new s.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,s._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,i=s._getValue(e,"preventDestroy",this);return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),i||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,i&&this.$el.contents().detach(),this):void 0},_destroyView:function(){var e=this.currentView;e.destroy&&!e.isDestroyed?e.destroy():e.remove&&(e.remove(),e.isDestroyed=!0)},attachView:function(e){return this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.getOption("el")),delete this.$el,this}},{buildRegion:function(e,t){if(i.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(i.isFunction(e))return this._buildRegionFromRegionClass(e);throw new s.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var n=e.regionClass||t,r=i.omit(e,"selector","regionClass");return e.selector&&!r.el&&(r.el=e.selector),new n(r)},_buildRegionFromRegionClass:function(e){return new e}}),s.RegionManager=s.Controller.extend({constructor:function(e){this._regions={},this.length=0,s.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=s._getValue(e,this,arguments),i.reduce(e,(function(e,n,r){return i.isString(n)&&(n={selector:n}),n.selector&&(n=i.defaults({},n,t)),e[r]=this.addRegion(r,n),e}),{},this)},addRegion:function(e,t){var i;return i=t instanceof s.Region?t:s.Region.buildRegion(t,s.Region),this.triggerMethod("before:add:region",e,i),i._parent=this,this._store(e,i),this.triggerMethod("add:region",e,i),i},get:function(e){return this._regions[e]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return i.each(this._regions,(function(e,t){this._remove(t,e)}),this),e},emptyRegions:function(){var e=this.getRegions();return i.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),s.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),s.actAsCollection(s.RegionManager.prototype,"_regions"),s.TemplateCache=function(e){this.templateId=e},i.extend(s.TemplateCache,{templateCaches:{},get:function(e,t){var i=this.templateCaches[e];return i||(i=new s.TemplateCache(e),this.templateCaches[e]=i),i.load(t)},clear:function(){var e,t=i.toArray(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),i.extend(s.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e){var i=t.$(e).html();if(!i||0===i.length)throw new s.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return i},compileTemplate:function(e,t){return i.template(e,t)}}),s.Renderer={render:function(e,t){if(!e)throw new s.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});return(i.isFunction(e)?e:s.TemplateCache.get(e))(t)}},s.View=t.View.extend({isDestroyed:!1,constructor:function(e){i.bindAll(this,"render"),e=s._getValue(e,this),this.options=i.extend({},i.result(this,"options"),e),this._behaviors=s.Behaviors(this),t.View.call(this,this.options),s.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,i.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=s._getValue(t,this),i.extend(e,t)},normalizeUIKeys:function(e){var t=i.result(this,"_uiBindings");return s.normalizeUIKeys(e,t||i.result(this,"ui"))},normalizeUIValues:function(e,t){var n=i.result(this,"ui"),r=i.result(this,"_uiBindings");return s.normalizeUIValues(e,r||n,t)},configureTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(i.result(this,"triggers"));return i.reduce(e,(function(e,t,i){return e[i]=this._buildViewTrigger(t),e}),{},this)}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,(function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))}),this),this},_delegateDOMEvents:function(e){var n=s._getValue(e||this.events,this);n=this.normalizeUIKeys(n),i.isUndefined(e)&&(this.events=n);var r={},o=i.result(this,"behaviorEvents")||{},h=this.configureTriggers(),a=i.result(this,"behaviorTriggers")||{};i.extend(r,o,n,h,a),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,(function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))}),this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new s.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=i.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),i.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=i.result(this,"_uiBindings");this.ui={},i.each(e,(function(e,t){this.ui[t]=this.$(e)}),this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,(function(e,t){delete this.ui[t]}),this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=i.isObject(e),n=i.defaults({},t?e:{},{preventDefault:!0,stopPropagation:!0}),r=t?n.event:e;return function(e){e&&(e.preventDefault&&n.preventDefault&&e.preventDefault(),e.stopPropagation&&n.stopPropagation&&e.stopPropagation());var t={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,t)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=s._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],i.rest(arguments)),e},_triggerEventOnBehaviors:function(e){for(var t=s._triggerMethod,i=this._behaviors,n=0,r=i&&i.length;r>n;n++)t(i[n],e)},_triggerEventOnParentLayout:function(e,t){var n=this._parentLayoutView();if(n){var r=s.getOption(n,"childViewEventPrefix")+":"+e;s._triggerMethod(n,[r,this].concat(t));var o=s.getOption(n,"childEvents"),h=n.normalizeMethods(o);h&&i.isFunction(h[e])&&h[e].apply(n,[this].concat(t))}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?i.reduce(e,(function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e}),e):e},_getAncestors:function(){for(var e=[],t=this._parent;t;)e.push(t),t=t._parent;return e},_parentLayoutView:function(){var e=this._getAncestors();return i.find(e,(function(e){return e instanceof s.LayoutView}))},normalizeMethods:s.normalizeMethods,mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.ItemView=s.View.extend({constructor:function(){s.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,i.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(!1!==e){if(!e)throw new s.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),i=s.Renderer.render(e,t,this);return this.attachElContent(i),this}},attachElContent:function(e){return this.$el.html(e),this}}),s.CollectionView=s.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(){this.once("render",this._initialEvents),this._initChildViewStorage(),s.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e,t=this._isShown&&s.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),t&&this._triggerBeforeAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),t&&this._triggerAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,n){var r=i.drop(arguments,3);i.each(e,(function(e){s.triggerMethodOn.apply(e,[e,n,e,t].concat(r))}))},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,n){var r;if(r=void 0!==n.at?n.at:i.indexOf(this._filteredSortedModels(),e),this._shouldAddChild(e,r)){this.destroyEmptyView();var s=this.getChildView(e);this.addChild(e,s,r)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each((function(e){s.triggerMethodOn(e,"before:show",e)}))},_onShowCalled:function(){this.children.each((function(e){s.triggerMethodOn(e,"show",e)}))},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels();if(i.find(t,(function(t){return!e.findByModel(t)})))this.render();else{var n=i.map(t,(function(t,i){var n=e.findByModel(t);return n._index=i,n.el}));this.triggerMethod("before:reorder"),this._appendReorderedChildren(n),this.triggerMethod("reorder")}},resortView:function(){s.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels();i.find(e,(function(e,t){var i=this.children.findByModel(e);return!i||i._index!==t}),this)&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();i.each(t,(function(t,i){e=this.getChildView(t),this.addChild(t,e,i)}),this)},_filteredSortedModels:function(){var e,t=this.getViewComparator();return e=t?i.isString(t)||1===t.length?this.collection.sortBy(t,this):i.clone(this.collection.models).sort(i.bind(t,this)):this.collection.models,this.getOption("filter")&&(e=i.filter(e,(function(e,t){return this._shouldAddChild(e,t)}),this)),e},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new t.Model;this.addEmptyView(i,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var n,r=this._isShown&&!this.isBuffering&&s.isNodeAttached(this.el),o=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");i.isFunction(o)&&(o=o.call(this,e,this._emptyViewIndex));var h=this.buildChildView(e,t,o);h._parent=this,this.proxyChildEvents(h),this._isShown&&s.triggerMethodOn(h,"before:show",h),this.children.add(h),r&&this._triggerBeforeAttach&&(n=[h].concat(h._getNestedViews()),h.once("render",(function(){this._triggerMethodMany(n,this,"before:attach")}),this)),this.renderChildView(h,this._emptyViewIndex),r&&this._triggerAttach&&(n=[h].concat(h._getNestedViews()),this._triggerMethodMany(n,this,"attach")),this._isShown&&s.triggerMethodOn(h,"show",h)},getChildView:function(){var e=this.getOption("childView");if(!e)throw new s.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return e},addChild:function(e,t,i){var n=this.getOption("childViewOptions");n=s._getValue(n,this,[e,i]);var r=this.buildChildView(e,t,n);return this._updateIndices(r,!0,i),this.triggerMethod("before:add:child",r),this._addChildView(r,i),this.triggerMethod("add:child",r),r._parent=this,r},_updateIndices:function(e,t,i){this.getOption("sort")&&(t&&(e._index=i),this.children.each((function(i){i._index>=e._index&&(i._index+=t?1:-1)})))},_addChildView:function(e,t){var i,n=this._isShown&&!this.isBuffering&&s.isNodeAttached(this.el);this.proxyChildEvents(e),this._isShown&&!this.isBuffering&&s.triggerMethodOn(e,"before:show",e),this.children.add(e),n&&this._triggerBeforeAttach&&(i=[e].concat(e._getNestedViews()),e.once("render",(function(){this._triggerMethodMany(i,this,"before:attach")}),this)),this.renderChildView(e,t),n&&this._triggerAttach&&(i=[e].concat(e._getNestedViews()),this._triggerMethodMany(i,this,"attach")),this._isShown&&!this.isBuffering&&s.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.render(),this.attachHtml(this,e,t),e},buildChildView:function(e,t,n){return new t(i.extend({model:e},n))},removeChildView:function(e){return e&&(this.triggerMethod("before:remove:child",e),e.destroy?e.destroy():e.remove&&e.remove(),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1)),e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return i.each(this._bufferedChildren,(function(t){e.appendChild(t.el)})),e},attachHtml:function(e,t,i){e.isBuffering?e._bufferedChildren.splice(i,0,t):e._insertBefore(t,i)||e._insertAfter(t)},_insertBefore:function(e,t){var i;return this.getOption("sort")&&this.children.length-1>t&&(i=this.children.find((function(e){return e._index===t+1}))),!!i&&(i.$el.before(e.el),!0)},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),s.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},n=!0,r=this.children.map(i.identity);return i.isUndefined(t.checkEmpty)||(n=t.checkEmpty),this.children.each(this.removeChildView,this),n&&this.checkEmpty(),r},_shouldAddChild:function(e,t){var n=this.getOption("filter");return!i.isFunction(n)||n.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",(function(){var n=i.toArray(arguments),r=n[0],s=this.normalizeMethods(i.result(this,"childEvents"));n[0]=t+":"+r,n.splice(1,0,e),void 0!==s&&i.isFunction(s[r])&&s[r].apply(this,n.slice(1)),this.triggerMethod.apply(this,n)}))},_getImmediateChildren:function(){return i.values(this.children._views)},getViewComparator:function(){return this.getOption("viewComparator")}}),s.CompositeView=s.CollectionView.extend({constructor:function(){s.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(){return this.getOption("childView")||this.constructor},serializeData:function(){var e={};return this.model&&(e=i.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&s.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),i=s.Renderer.render(t,e,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){this.getChildViewContainer(e).append(t)},_insertAfter:function(e){this.getChildViewContainer(this,e).append(e.el)},_appendReorderedChildren:function(e){this.getChildViewContainer(this).append(e)},getChildViewContainer:function(e){if(e.$childViewContainer)return e.$childViewContainer;var t,i=s.getOption(e,"childViewContainer");if(i){var n=s._getValue(i,e);if(0>=(t="@"===n.charAt(0)&&e.ui?e.ui[n.substr(4)]:e.$(n)).length)throw new s.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else t=e.$el;return e.$childViewContainer=t,t},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),s.LayoutView=s.ItemView.extend({regionClass:s.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),s.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),s.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(!0===this.getOption("destroyImmediate")&&this.$el.remove(),this.regionManager.destroy(),s.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t){return this.getRegion(e).show(t)},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var i={};return i[e]=t,this._buildRegions(i)[e]},addRegions:function(e){return this.regions=i.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:i.partial(i.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=s._getValue(this.regions,this,[e])||{};var n=this.getOption.call(e,"regions");n=s._getValue(n,this,[e]),i.extend(t,n),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new s.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",(function(e){this.triggerMethod("before:add:region",e)})),this.listenTo(this.regionManager,"add:region",(function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)})),this.listenTo(this.regionManager,"before:remove:region",(function(e){this.triggerMethod("before:remove:region",e)})),this.listenTo(this.regionManager,"remove:region",(function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)}))},_getImmediateChildren:function(){return i.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),s.Behavior=s.Object.extend({constructor:function(e,t){this.view=t,this.defaults=i.result(this,"defaults")||{},this.options=i.extend({},this.defaults,e),this.ui=i.extend({},i.result(t,"ui"),i.result(this,"ui")),s.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),s.Behaviors=function(e,t){function i(e,n){return t.isObject(e.behaviors)?(n=i.parseBehaviors(e,n||t.result(e,"behaviors")),i.wrap(e,n,t.keys(o)),n):{}}function n(e,t){this._view=e,this._behaviors=t,this._triggers={}}function r(e){return e._uiBindings||e.ui}var s=/^(\S+)\s*(.*)$/,o={behaviorTriggers:function(e,t){return new n(this,t).buildBehaviorTriggers()},behaviorEvents:function(i,n){var o={};return t.each(n,(function(i,n){var h={},a=t.clone(t.result(i,"events"))||{};a=e.normalizeUIKeys(a,r(i));var u=0;t.each(a,(function(e,r){var o=r.match(s),a=o[1]+"."+[this.cid,n,u++," "].join("")+o[2],c=t.isFunction(e)?e:i[e];h[a]=t.bind(c,i)}),this),o=t.extend(o,h)}),this),o}};return t.extend(i,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,n){return t.behaviorClass?t.behaviorClass:e._getValue(i.behaviorsLookup,this,[t,n])[n]},parseBehaviors:function(e,n){return t.chain(n).map((function(n,r){var s=new(i.getBehaviorClass(n,r))(n,e),o=i.parseBehaviors(e,t.result(s,"behaviors"));return[s].concat(o)})).flatten().value()},wrap:function(e,i,n){t.each(n,(function(n){e[n]=t.partial(o[n],e[n],i)}))}}),t.extend(n.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var s=t.clone(t.result(i,"triggers"))||{};s=e.normalizeUIKeys(s,r(i)),t.each(s,t.bind(this._setHandlerForBehavior,this,i,n))},_setHandlerForBehavior:function(e,t,i,n){var r=n.replace(/^\S+/,(function(e){return e+".behaviortriggers"+t}));this._triggers[r]=this._view._buildViewTrigger(i)}}),i}(s,i),s.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var i=this._getController();this._addAppRoute(i,e,t)},_processOnRoute:function(e,t){if(i.isFunction(this.onRoute)){var n=i.invert(this.getOption("appRoutes"))[e];this.onRoute(e,n,t)}},processAppRoutes:function(e,t){if(t){var n=i.keys(t).reverse();i.each(n,(function(i){this._addAppRoute(e,i,t[i])}),this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,n){var r=e[n];if(!r)throw new s.Error('Method "'+n+'" was not found on the controller');this.route(t,n,i.bind(r,e))},mergeOptions:s.mergeOptions,getOption:s.proxyGetOption,triggerMethod:s.triggerMethod,bindEntityEvents:s.proxyBindEntityEvents,unbindEntityEvents:s.proxyUnbindEntityEvents}),s.Application=s.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new s.Callbacks,this.submodules={},i.extend(this,e),this._initChannel(),s.Object.call(this,e)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var n=s.Module.getClass(t),r=i.toArray(arguments);return r.unshift(this),n.create.apply(n,r)},getRegionManager:function(){return new s.RegionManager},_initializeRegions:function(e){var t=i.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var n=s.getOption(e,"regions");return i.isFunction(n)&&(n=n.call(this,e)),i.extend(t,n),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",(function(){s._triggerMethod(this,"before:add:region",arguments)})),this.listenTo(this._regionManager,"add:region",(function(e,t){this[e]=t,s._triggerMethod(this,"add:region",arguments)})),this.listenTo(this._regionManager,"before:remove:region",(function(){s._triggerMethod(this,"before:remove:region",arguments)})),this.listenTo(this._regionManager,"remove:region",(function(e){delete this[e],s._triggerMethod(this,"remove:region",arguments)}))},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres}}),s.Module=function(e,t,n){this.moduleName=e,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,i.isFunction(this.initialize)&&this.initialize(e,t,this.options)},s.Module.extend=s.extend,i.extend(s.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(i.each(this.submodules,(function(t){t.startWithParent&&t.start(e)})),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,n){if(e){var r=i.flatten([this,this.app,t,s,t.$,i,n]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new s.Callbacks,this._finalizerCallbacks=new s.Callbacks},triggerMethod:s.triggerMethod}),i.extend(s.Module,{create:function(e,t,n){var r=e,s=i.drop(arguments,3),o=(t=t.split(".")).length,h=[];return h[o-1]=n,i.each(t,(function(t,i){var o=r;r=this._getModule(o,t,e,n),this._addModuleDefinition(o,r,h[i],s)}),this),r},_getModule:function(e,t,n,r){var s=i.extend({},r),o=this.getClass(r),h=e[t];return h||(h=new o(t,n,s),e[t]=h,e.submodules[t]=h),h},getClass:function(e){var t=s.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,i,n){var r=this._getDefine(i),s=this._getStartWithParent(i,t);r&&t.addDefinition(r,n),this._addStartWithParent(e,t,s)},_getStartWithParent:function(e,t){var n;return i.isFunction(e)&&e.prototype instanceof s.Module?(n=t.constructor.prototype.startWithParent,!!i.isUndefined(n)||n):!i.isObject(e)||(n=e.startWithParent,!!i.isUndefined(n)||n)},_getDefine:function(e){return!i.isFunction(e)||e.prototype instanceof s.Module?i.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,i){t.startWithParent=t.startWithParent&&i,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer((function(e){t.startWithParent&&t.start(e)})))}}),s})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define(["underscore","backbone"],t):e.Backbone.Radio=t(e._,e.Backbone)}(this,(function(e,t){"use strict";function i(e,t,i,n){var r=e[t];return i&&i!==r.callback&&i!==r.callback._callback||n&&n!==r.context?void 0:(delete e[t],!0)}function n(t,n,r,s){t||(t={});for(var o=n?[n]:e.keys(t),h=!1,a=0,u=o.length;u>a;a++)t[n=o[a]]&&i(t,n,r,s)&&(h=!0);return h}function r(t){return u[t]||(u[t]=e.partial(h.log,t))}function s(t){return e.isFunction(t)?t:function(){return t}}var o=t.Radio,h=t.Radio={};h.VERSION="1.0.1",h.noConflict=function(){return t.Radio=o,this},h.DEBUG=!1,h._debugText=function(e,t,i){return e+(i?" on the "+i+" channel":"")+': "'+t+'"'},h.debugLog=function(e,t,i){h.DEBUG&&console&&console.warn&&console.warn(h._debugText(e,t,i))};var a=/\s+/;h._eventsApi=function(t,i,n,r){if(!n)return!1;var s={};if("object"==typeof n){for(var o in n){var h=t[i].apply(t,[o,n[o]].concat(r));a.test(o)?e.extend(s,h):s[o]=h}return s}if(a.test(n)){for(var u=n.split(a),c=0,l=u.length;l>c;c++)s[u[c]]=t[i].apply(t,[u[c]].concat(r));return s}return!1},h._callHandler=function(e,t,i){var n=i[0],r=i[1],s=i[2];switch(i.length){case 0:return e.call(t);case 1:return e.call(t,n);case 2:return e.call(t,n,r);case 3:return e.call(t,n,r,s);default:return e.apply(t,i)}};var u={};e.extend(h,{log:function(t,i){var n=e.rest(arguments,2);console.log("["+t+'] "'+i+'"',n)},tuneIn:function(e){var t=h.channel(e);return t._tunedIn=!0,t.on("all",r(e)),this},tuneOut:function(e){var t=h.channel(e);return t._tunedIn=!1,t.off("all",r(e)),delete u[e],this}}),h.Requests={request:function(t){var i=e.rest(arguments),n=h._eventsApi(this,"request",t,i);if(n)return n;var r=this.channelName,s=this._requests;if(r&&this._tunedIn&&h.log.apply(this,[r,t].concat(i)),s&&(s[t]||s.default)){var o=s[t]||s.default;return i=s[t]?i:arguments,h._callHandler(o.callback,o.context,i)}h.debugLog("An unhandled request was fired",t,r)},reply:function(e,t,i){return h._eventsApi(this,"reply",e,[t,i])||(this._requests||(this._requests={}),this._requests[e]&&h.debugLog("A request was overwritten",e,this.channelName),this._requests[e]={callback:s(t),context:i||this}),this},replyOnce:function(t,i,n){if(h._eventsApi(this,"replyOnce",t,[i,n]))return this;var r=this,o=e.once((function(){return r.stopReplying(t),s(i).apply(this,arguments)}));return this.reply(t,o,n)},stopReplying:function(e,t,i){return h._eventsApi(this,"stopReplying",e)||(e||t||i?n(this._requests,e,t,i)||h.debugLog("Attempted to remove the unregistered request",e,this.channelName):delete this._requests),this}},h._channels={},h.channel=function(e){if(!e)throw new Error("You must provide a name for the channel.");return h._channels[e]?h._channels[e]:h._channels[e]=new h.Channel(e)},h.Channel=function(e){this.channelName=e},e.extend(h.Channel.prototype,t.Events,h.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var c,l,d=[t.Events,h.Commands,h.Requests];return e.each(d,(function(t){e.each(t,(function(t,i){h[i]=function(t){return l=e.rest(arguments),(c=this.channel(t))[i].apply(c,l)}}))})),h.reset=function(t){var i=t?[this._channels[t]]:this._channels;e.invoke(i,"reset")},h})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Mexp=t()}(this,(function(){"use strict";function e(){return(e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}var t,i={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1};function n(e,t){for(var i=0;i<e.length;i++)e[i]+=t;return e}!function(e){e[e.FUNCTION_WITH_ONE_ARG=0]="FUNCTION_WITH_ONE_ARG",e[e.NUMBER=1]="NUMBER",e[e.BINARY_OPERATOR_HIGH_PRECENDENCE=2]="BINARY_OPERATOR_HIGH_PRECENDENCE",e[e.CONSTANT=3]="CONSTANT",e[e.OPENING_PARENTHESIS=4]="OPENING_PARENTHESIS",e[e.CLOSING_PARENTHESIS=5]="CLOSING_PARENTHESIS",e[e.DECIMAL=6]="DECIMAL",e[e.POSTFIX_FUNCTION_WITH_ONE_ARG=7]="POSTFIX_FUNCTION_WITH_ONE_ARG",e[e.FUNCTION_WITH_N_ARGS=8]="FUNCTION_WITH_N_ARGS",e[e.BINARY_OPERATOR_LOW_PRECENDENCE=9]="BINARY_OPERATOR_LOW_PRECENDENCE",e[e.BINARY_OPERATOR_PERMUTATION=10]="BINARY_OPERATOR_PERMUTATION",e[e.COMMA=11]="COMMA",e[e.EVALUATED_FUNCTION=12]="EVALUATED_FUNCTION",e[e.EVALUATED_FUNCTION_PARAMETER=13]="EVALUATED_FUNCTION_PARAMETER",e[e.SPACE=14]="SPACE"}(t||(t={}));var r={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0},s={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0},o={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0},h={},a={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0},u={1:!0},c=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function l(e,t,i,n){for(var r=0;r<n;r++)if(e[i+r]!==t[r])return!1;return!0}function d(e){for(var n=0;n<e.length;n++){var r=e[n].token.length,s=-1;e[n].type===t.FUNCTION_WITH_N_ARGS&&void 0===e[n].numberOfArguments&&(e[n].numberOfArguments=2),c[r]=c[r]||[];for(var o=0;o<c[r].length;o++)if(e[n].token===c[r][o]){s=f(c[r][o],this.tokens);break}-1===s?(this.tokens.push(e[n]),e[n].precedence=i[e[n].type],c.length<=e[n].token.length&&(c[e[n].token.length]=[]),c[e[n].token.length].push(e[n].token)):(this.tokens[s]=e[n],e[n].precedence=i[e[n].type])}}function f(e,t){for(var i=0;i<t.length;i++)if(t[i].token===e)return i;return-1}var g=function(e,t){var i,d={value:this.math.changeSign,type:0,precedence:1,show:"-"},g={value:")",show:")",type:5,precedence:0},p={value:"(",type:4,precedence:0,show:"("},v=[p],m=[],_=e,y=r,w=0,E=h,C="";void 0!==t&&this.addToken(t);var M=function(e,t){for(var i,n,r,s=[],o=t.length,h=0;h<o;h++)if(!(h<o-1&&" "===t[h]&&" "===t[h+1])){for(i="",n=t.length-h>c.length-2?c.length-1:t.length-h;n>0;n--)if(void 0!==c[n])for(r=0;r<c[n].length;r++)l(t,c[n][r],h,n)&&(i=c[n][r],r=c[n].length,n=0);if(h+=i.length-1,""===i)throw new Error("Can't understand after "+t.slice(h));s.push(e.tokens[f(i,e.tokens)])}return s}(this,_);for(i=0;i<M.length;i++){var b=M[i];if(14!==b.type){var R,V=b.token,O=b.type,x=b.value,A=b.precedence,k=b.show,I=v[v.length-1];for(R=m.length;R--&&0===m[R];)if(-1!==[0,2,3,4,5,9,10,11,12,13].indexOf(O)){if(!0!==y[O])throw new Error(V+" is not allowed after "+C);v.push(g),y=s,E=a,m.pop()}if(!0!==y[O])throw new Error(V+" is not allowed after "+C);!0===E[O]&&(O=2,x=this.math.mul,k="&times;",A=3,i-=1);var T={value:x,type:O,precedence:A,show:k,numberOfArguments:b.numberOfArguments};if(0===O)y=r,E=h,n(m,2),v.push(T),4!==M[i+1].type&&(v.push(p),m.push(2));else if(1===O)1===I.type?(I.value+=x,n(m,1)):v.push(T),y=s,E=o;else if(2===O)y=r,E=h,n(m,2),v.push(T);else if(3===O)v.push(T),y=s,E=a;else if(4===O)n(m,1),w++,y=r,E=h,v.push(T);else if(5===O){if(!w)throw new Error("Closing parenthesis are more than opening one, wait What!!!");w--,y=s,E=a,v.push(T),n(m,1)}else if(6===O){if(I.hasDec)throw new Error("Two decimals are not allowed in one number");1!==I.type&&(I={show:"0",value:0,type:1,precedence:0},v.push(I)),y=u,n(m,1),E=h,I.value+=x,I.hasDec=!0}else 7===O&&(y=s,E=a,n(m,1),v.push(T));8===O?(y=r,E=h,n(m,b.numberOfArguments+2),v.push(T),4!==M[i+1].type&&(v.push(p),m.push(b.numberOfArguments+2))):9===O?(9===I.type?I.value===this.math.add?(I.value=x,I.show=k,n(m,1)):I.value===this.math.sub&&"-"===k&&(I.value=this.math.add,I.show="+",n(m,1)):5!==I.type&&7!==I.type&&1!==I.type&&3!==I.type&&13!==I.type?"-"===V&&(y=r,E=h,n(m,2).push(2),v.push(d),v.push(p)):(v.push(T),n(m,2)),y=r,E=h):10===O?(y=r,E=h,n(m,2),v.push(T)):11===O?(y=r,E=h,v.push(T)):12===O?(y=r,E=h,n(m,6),v.push(T),4!==M[i+1].type&&(v.push(p),m.push(6))):13===O&&(y=s,E=a,v.push(T)),n(m,-1),C=V}else if(i>0&&i<M.length-1&&1===M[i+1].type&&(1===M[i-1].type||6===M[i-1].type))throw new Error("Unexpected Space")}for(R=m.length;R--;)v.push(g);if(!0!==y[5])throw new Error("complete the expression");for(;w--;)v.push(g);return v.push(g),v};function p(e){for(var t,i,n,r=[],s=-1,o=-1,h=[{value:"(",type:4,precedence:0,show:"("}],a=1;a<e.length;a++)if(1===e[a].type||3===e[a].type||13===e[a].type)1===e[a].type&&(e[a].value=Number(e[a].value)),r.push(e[a]);else if(4===e[a].type)h.push(e[a]);else if(5===e[a].type)for(;4!==(null==(u=i=h.pop())?void 0:u.type);){var u;i&&r.push(i)}else if(11===e[a].type){for(;4!==(null==(c=i=h.pop())?void 0:c.type);){var c;i&&r.push(i)}h.push(i)}else{o=(t=e[a]).precedence,s=(n=h[h.length-1]).precedence;var l="Math.pow"==n.value&&"Math.pow"==t.value;if(o>s)h.push(t);else{for(;s>=o&&!l||l&&o<s;)i=h.pop(),n=h[h.length-1],i&&r.push(i),s=n.precedence,l="Math.pow"==t.value&&"Math.pow"==n.value;h.push(t)}}return r}function v(e,t){(t=t||{}).PI=Math.PI,t.E=Math.E;for(var i,n,r,s=[],o=void 0!==t.n,h=0;h<e.length;h++)if(1===e[h].type)s.push({value:e[h].value,type:1});else if(3===e[h].type)s.push({value:t[e[h].value],type:1});else if(0===e[h].type){var a=s[s.length-1];Array.isArray(a)?a.push(e[h]):a.value=e[h].value(a.value)}else if(7===e[h].type){var u=s[s.length-1];Array.isArray(u)?u.push(e[h]):u.value=e[h].value(u.value)}else if(8===e[h].type){for(var c=[],l=0;l<e[h].numberOfArguments;l++){var d=s.pop();d&&c.push(d.value)}s.push({type:1,value:e[h].value.apply(e[h],c.reverse())})}else if(10===e[h].type)i=s.pop(),n=s.pop(),Array.isArray(n)?((n=n.concat(i)).push(e[h]),s.push(n)):Array.isArray(i)?(i.unshift(n),i.push(e[h]),s.push(i)):s.push({type:1,value:e[h].value(n.value,i.value)});else if(2===e[h].type||9===e[h].type)i=s.pop(),n=s.pop(),Array.isArray(n)?((n=n.concat(i)).push(e[h]),s.push(n)):Array.isArray(i)?(i.unshift(n),i.push(e[h]),s.push(i)):s.push({type:1,value:e[h].value(n.value,i.value)});else if(12===e[h].type){i=s.pop();var f;f=!Array.isArray(i)&&i?[i]:i||[],n=s.pop(),r=s.pop(),s.push({type:1,value:e[h].value(r.value,n.value,f)})}else 13===e[h].type&&(o?s.push({value:t[e[h].value],type:3}):s.push([e[h]]));if(s.length>1)throw new Error("Uncaught Syntax error");return parseFloat(s[0].value.toFixed(15))}var m=function(){function t(){var t;this.toPostfix=p,this.addToken=d,this.lex=g,this.postfixEval=v,this.math=(t=this,{isDegree:!0,acos:function(e){return t.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return t.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return t.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,i){var n=1,r=e-i,s=i;s<r&&(s=r,r=i);for(var o=s+1;o<=e;o++)n*=o;var h=t.math.fact(r);return"NaN"===h?"NaN":n/h},changeSign:function(e){return-e},cos:function(e){return t.math.isDegree&&(e=t.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!=0)return"NaN";for(var t=1,i=2;i<=e;i++)t*=i;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var i=1,n=Math.floor(e)-Math.floor(t)+1;n<=Math.floor(e);n++)i*=n;return i},Pi:function(e,i,n){for(var r=1,s=e;s<=i;s++)r*=Number(t.postfixEval(n,{n:s}));return r},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,i,n){for(var r=0,s=e;s<=i;s++)r+=Number(t.postfixEval(n,{n:s}));return r},sin:function(e){return t.math.isDegree&&(e=t.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return t.math.isDegree&&(e=t.math.toRadian(e)),Math.tan(e)},tanh:function(e){return t.math.sinh(e)/t.math.cosh(e)},toRadian:function(e){return e*Math.PI/180},and:function(e,t){return e&t}}),this.tokens=function(t){return[{token:"sin",show:"sin",type:0,value:t.math.sin},{token:"cos",show:"cos",type:0,value:t.math.cos},{token:"tan",show:"tan",type:0,value:t.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:t.math.P},{token:"C",show:"C",type:10,value:t.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:t.math.asin},{token:"acos",show:"acos",type:0,value:t.math.acos},{token:"atan",show:"atan",type:0,value:t.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:t.math.cosh},{token:"acosh",show:"acosh",type:0,value:t.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:t.math.div},{token:"!",show:"!",type:7,value:t.math.fact},{token:"tanh",show:"tanh",type:0,value:t.math.tanh},{token:"atanh",show:"atanh",type:0,value:t.math.atanh},{token:"Mod",show:" Mod ",type:2,value:t.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:t.math.mul},{token:"sinh",show:"sinh",type:0,value:t.math.sinh},{token:"asinh",show:"asinh",type:0,value:t.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:t.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:t.math.add},{token:"-",show:"-",type:9,value:t.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:t.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:t.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:t.math.and}].map((function(t){return e({},t,{precedence:i[t.type]})}))}(this)}return t.prototype.eval=function(e,t,i){return this.postfixEval(this.toPostfix(this.lex(e,t)),i)},t}();return m.TOKEN_TYPES=t,m.tokenTypes=t,m}));var nfRadio=Backbone.Radio;nfRadio.channel("form").on("render:view",(function(){jQuery(".g-recaptcha").each((function(){var e=jQuery(this).data("callback"),t=jQuery(this).data("fieldid");"function"!=typeof window[e]&&(window[e]=function(e){nfRadio.channel("recaptcha").request("update:response",e,t)})}))}));var nfRecaptcha=Marionette.Object.extend({initialize:function(){0!=jQuery(".g-recaptcha").length&&this.renderCaptcha(),this.listenTo(nfRadio.channel("form"),"render:view",this.renderCaptcha),this.listenTo(nfRadio.channel("captcha"),"reset",this.renderCaptcha)},renderCaptcha:function(){jQuery(".g-recaptcha:empty").each((function(){var e={fieldid:jQuery(this).data("fieldid"),size:jQuery(this).data("size"),theme:jQuery(this).data("theme"),sitekey:jQuery(this).data("sitekey"),callback:jQuery(this).data("callback")},t=grecaptcha.render(jQuery(this)[0],e);if("invisible"===e.size)try{nf_reprocess_recaptcha(t),setInterval(nf_reprocess_recaptcha,11e4,t)}catch(e){console.log("Notice: Error trying to execute grecaptcha.")}}))}}),nfRenderRecaptcha=function(){new nfRecaptcha};const nf_reprocess_recaptcha=e=>{grecaptcha.execute(e)},nf_check_recaptcha_consent=()=>{let e=[],t=[];nf_check_data_for_recaptcha_consent()||(e.push(!1),t.push("missing_cookie"));const i={consent_state:e,services:t};nfFrontEnd.nf_consent_status_response=i;let n=new CustomEvent("nf_consent_status_check",{detail:i});return document.dispatchEvent(n),nfFrontEnd.nf_consent_status_response},nf_check_data_for_recaptcha_consent=()=>""!==nf_get_cookie_by_name("_grecaptcha"),nf_get_cookie_by_name=e=>{let t=e+"=",i=decodeURIComponent(document.cookie).split(";");for(let e=0;e<i.length;e++){let n=i[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},nf_reload_after_cookie_consent=(e,t)=>{void 0!==e&&void 0!==t&&(nfRadio.channel("fields").request("remove:error",e,"recaptcha-v3-missing"),nfRadio.channel("fields").request("remove:error",e,"recaptcha-v3-consent"),nfRadio.channel("form").trigger("render:view",t))},nf_add_reCaptcha_aria=()=>{const e=(e,t)=>{for(const i of e)if("childList"===i.type&&"g-recaptcha"===i.target.className){let e=document.getElementById("g-recaptcha-response");void 0!==e&&(e.setAttribute("aria-hidden","true"),e.setAttribute("aria-label","Silent reCaptcha security check"),e.setAttribute("aria-readonly","true"),t.disconnect())}t.disconnect()},t=document.querySelectorAll(".ninja-forms-form-wrap");if(t.length>0){let i=[];t.forEach((t=>{i.push({class:new MutationObserver(e),element:t})})),i.length>0&&i.forEach((e=>{e.class.observe(e.element,{childList:!0,subtree:!0})}))}},nf_remove_noscript_tags_as_needed=()=>{const e=document.getElementsByClassName("ninja-forms-noscript-message");for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])};jQuery(document).on("nfFormReady",(()=>{nf_remove_noscript_tags_as_needed(),nf_add_reCaptcha_aria()}));